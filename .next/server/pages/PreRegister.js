"use strict";(()=>{var e={};e.id=42,e.ids=[42,660],e.modules={654:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>N,default:()=>u,getServerSideProps:()=>f,getStaticPaths:()=>x,getStaticProps:()=>p,reportWebVitals:()=>j,routeModule:()=>y,unstable_getServerProps:()=>g,unstable_getServerSideProps:()=>O,unstable_getStaticParams:()=>w,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>b});var s=a(7093),o=a(5244),n=a(1323),i=a(1682),l=a.n(i),d=a(8141),c=a.n(d),m=a(6630),h=e([m]);m=(h.then?(await h)():h)[0];let u=(0,n.l)(m,"default"),p=(0,n.l)(m,"getStaticProps"),x=(0,n.l)(m,"getStaticPaths"),f=(0,n.l)(m,"getServerSideProps"),N=(0,n.l)(m,"config"),j=(0,n.l)(m,"reportWebVitals"),b=(0,n.l)(m,"unstable_getStaticProps"),v=(0,n.l)(m,"unstable_getStaticPaths"),w=(0,n.l)(m,"unstable_getStaticParams"),g=(0,n.l)(m,"unstable_getServerProps"),O=(0,n.l)(m,"unstable_getServerSideProps"),y=new s.PagesRouteModule({definition:{kind:o.x.PAGES,page:"/PreRegister",pathname:"/PreRegister",bundlePath:"",filename:""},components:{App:c(),Document:l()},userland:m});t()}catch(e){t(e)}})},1414:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.d(r,{RM:()=>c,SC:()=>m,iA:()=>l,pj:()=>u,ss:()=>h,xD:()=>d});var s=a(997),o=a(6689),n=a(1073),i=e([n]);n=(i.then?(await i)():i)[0];let l=o.forwardRef(({className:e,...r},a)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:a,className:(0,n.cn)("w-full caption-bottom text-sm",e),...r})}));l.displayName="Table";let d=o.forwardRef(({className:e,...r},a)=>s.jsx("thead",{ref:a,className:(0,n.cn)("[&_tr]:border-b",e),...r}));d.displayName="TableHeader";let c=o.forwardRef(({className:e,...r},a)=>s.jsx("tbody",{ref:a,className:(0,n.cn)("[&_tr:last-child]:border-0",e),...r}));c.displayName="TableBody",o.forwardRef(({className:e,...r},a)=>s.jsx("tfoot",{ref:a,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...r})).displayName="TableFooter";let m=o.forwardRef(({className:e,...r},a)=>s.jsx("tr",{ref:a,className:(0,n.cn)("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...r}));m.displayName="TableRow";let h=o.forwardRef(({className:e,...r},a)=>s.jsx("th",{ref:a,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...r}));h.displayName="TableHead";let u=o.forwardRef(({className:e,...r},a)=>s.jsx("td",{ref:a,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...r}));u.displayName="TableCell",o.forwardRef(({className:e,...r},a)=>s.jsx("caption",{ref:a,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",e),...r})).displayName="TableCaption",t()}catch(e){t(e)}})},6179:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(3592).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},1560:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(3592).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},6630:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{default:()=>j});var s=a(997),o=a(6689);(function(){var e=Error("Cannot find module 'react-router-dom'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/integrations/supabase/client'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module '@/components/Layout'");throw e.code="MODULE_NOT_FOUND",e}();var n=a(569),i=a(9322),l=a(6889),d=a(1612),c=a(2697),m=a(9721),h=a(1928),u=a(6179),p=a(1560),x=a(1414),f=a(7981);(function(){var e=Error("Cannot find module '@/utils/logger'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/utils/phone'");throw e.code="MODULE_NOT_FOUND",e}();var N=e([n,i,l,d,m,x,f]);function j(){let[e,r]=(0,o.useState)(!1),[a,t]=(0,o.useState)(null),[N,j]=(0,o.useState)(null),[b,v]=(0,o.useState)([]),[w,g]=(0,o.useState)({fullName:"",phone:"",role:"member"}),{toast:O}=(0,c.pm)();Object(function(){var e=Error("Cannot find module 'react-router-dom'");throw e.code="MODULE_NOT_FOUND",e}())();let y=async()=>{let{data:e,error:r}=await Object(function(){var e=Error("Cannot find module '@/integrations/supabase/client'");throw e.code="MODULE_NOT_FOUND",e}()).from("profiles").select("id, full_name, phone, role, created_at, address_street").eq("pre_registered",!0).order("created_at",{ascending:!1});if(r){Object(function(){var e=Error("Cannot find module '@/utils/logger'");throw e.code="MODULE_NOT_FOUND",e}())(r,"PreRegister - fetchPreRegisteredMembers");return}v(e||[])},_=async e=>{e.preventDefault(),r(!0);try{let e=await fetch(`${(void 0).VITE_BOLT_DATABASE_URL||(void 0).VITE_SUPABASE_URL}/functions/v1/pre-register-member`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(await Object(function(){var e=Error("Cannot find module '@/integrations/supabase/client'");throw e.code="MODULE_NOT_FOUND",e}()).auth.getSession()).data.session?.access_token}`},body:JSON.stringify({fullName:w.fullName,phone:Object(function(){var e=Error("Cannot find module '@/utils/phone'");throw e.code="MODULE_NOT_FOUND",e}())(w.phone),role:w.role})}),r=await e.json();if(console.log("Edge Function Response:",{status:e.status,data:r}),!e.ok)throw Error(r.error||`Erro ${e.status}: ${e.statusText}`);if(!r.success)throw Error(r.error);O({title:"Pr\xe9-cadastro realizado com sucesso!",description:`Senha gerada: ${r.password}`});try{await fetch("https://n8n-n8n.xm9jj7.easypanel.host/webhook/cadastro",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:w.fullName,phone:Object(function(){var e=Error("Cannot find module '@/utils/phone'");throw e.code="MODULE_NOT_FOUND",e}())(w.phone),role:w.role,password:r.password,createdAt:new Date().toISOString()})})}catch(e){console.error("Erro ao enviar para webhook:",e)}g({fullName:"",phone:"",role:"member"}),y()}catch(r){console.error("Erro capturado:",r);let e=r instanceof Error?r.message:"Erro desconhecido";O({title:"Erro ao realizar pr\xe9-cadastro",description:e,variant:"destructive"})}finally{r(!1)}},E=async(e,r,a)=>{t(e);try{let{data:t,error:s}=await Object(function(){var e=Error("Cannot find module '@/integrations/supabase/client'");throw e.code="MODULE_NOT_FOUND",e}()).functions.invoke("reset-user-password",{body:{userId:e}});if(s)throw s;if(!t.success)throw Error(t.error);O({title:"Senha resetada!",description:`Nova senha: ${t.newPassword}`});try{await fetch("https://n8n-n8n.xm9jj7.easypanel.host/webhook/cadastro",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:a,phone:r,password:t.newPassword,isResend:!0,createdAt:new Date().toISOString()})})}catch(e){console.error("Erro ao enviar para webhook:",e)}}catch(r){let e=r instanceof Error?r.message:"Erro desconhecido";O({title:"Erro ao resetar senha",description:e,variant:"destructive"})}finally{t(null)}},S=async e=>{j(e);try{let{error:r}=await Object(function(){var e=Error("Cannot find module '@/integrations/supabase/client'");throw e.code="MODULE_NOT_FOUND",e}()).from("profiles").update({pre_registered:!1}).eq("id",e);if(r)throw r;v(b.filter(r=>r.id!==e)),O({title:"Removido da lista",description:"O membro foi removido da lista de pr\xe9-cadastrados"})}catch(r){let e=r instanceof Error?r.message:"Erro desconhecido";O({title:"Erro ao remover da lista",description:e,variant:"destructive"})}finally{j(null)}};return s.jsx(Object(function(){var e=Error("Cannot find module '@/components/Layout'");throw e.code="MODULE_NOT_FOUND",e}()),{children:s.jsx("div",{className:"p-4 sm:p-6",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4 sm:space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Pr\xe9-Cadastro de Membros"}),s.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Cadastre novos membros no sistema"})]}),(0,s.jsxs)(d.Zb,{children:[(0,s.jsxs)(d.Ol,{children:[s.jsx(d.ll,{children:"Dados Iniciais"}),s.jsx(d.SZ,{children:"Uma senha aleat\xf3ria ser\xe1 gerada para o primeiro acesso"})]}),s.jsx(d.aY,{children:(0,s.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(l._,{htmlFor:"fullName",children:"Nome Completo *"}),s.jsx(i.I,{id:"fullName",value:w.fullName,onChange:e=>g({...w,fullName:e.target.value}),required:!0,disabled:e})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(l._,{htmlFor:"phone",children:"Telefone *"}),s.jsx(i.I,{id:"phone",type:"tel",placeholder:"(00) 00000-0000",value:w.phone,onChange:e=>g({...w,phone:Object(function(){var e=Error("Cannot find module '@/utils/phone'");throw e.code="MODULE_NOT_FOUND",e}())(e.target.value)}),required:!0,disabled:e,maxLength:15})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(l._,{htmlFor:"role",children:"N\xedvel de Acesso *"}),(0,s.jsxs)(m.Ph,{value:w.role,onValueChange:e=>g({...w,role:e}),disabled:e,children:[s.jsx(m.i4,{children:s.jsx(m.ki,{})}),(0,s.jsxs)(m.Bw,{children:[s.jsx(m.Ql,{value:"member",children:"Membro"}),s.jsx(m.Ql,{value:"admin",children:"Administrador"})]})]})]}),(0,s.jsxs)(n.z,{type:"submit",className:"w-full",disabled:e,children:[e&&s.jsx(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Realizar Pr\xe9-Cadastro"]})]})})]}),(0,s.jsxs)(d.Zb,{children:[(0,s.jsxs)(d.Ol,{children:[s.jsx(d.ll,{children:"Membros Pr\xe9-Cadastrados"}),s.jsx(d.SZ,{children:"Membros que ainda n\xe3o finalizaram o cadastro completo"})]}),s.jsx(d.aY,{children:0===b.length?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum membro pr\xe9-cadastrado encontrado"}):s.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:(0,s.jsxs)(x.iA,{children:[s.jsx(x.xD,{children:(0,s.jsxs)(x.SC,{children:[s.jsx(x.ss,{className:"min-w-[120px]",children:"Nome"}),s.jsx(x.ss,{className:"min-w-[100px]",children:"Telefone"}),s.jsx(x.ss,{className:"hidden sm:table-cell",children:"N\xedvel"}),s.jsx(x.ss,{className:"hidden md:table-cell",children:"Data"}),s.jsx(x.ss,{className:"text-right min-w-[100px]",children:"A\xe7\xf5es"})]})}),s.jsx(x.RM,{children:b.map(e=>(0,s.jsxs)(x.SC,{children:[s.jsx(x.pj,{className:"font-medium text-sm",children:e.full_name}),s.jsx(x.pj,{className:"text-sm",children:Object(function(){var e=Error("Cannot find module '@/utils/phone'");throw e.code="MODULE_NOT_FOUND",e}())(e.phone)}),s.jsx(x.pj,{className:"hidden sm:table-cell",children:s.jsx(f.C,{variant:"admin"===e.role?"default":"secondary",children:"admin"===e.role?"Admin":"Membro"})}),s.jsx(x.pj,{className:"hidden md:table-cell text-sm",children:new Date(e.created_at).toLocaleDateString("pt-BR")}),s.jsx(x.pj,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex justify-end gap-1",children:[s.jsx(n.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>E(e.id,e.phone,e.full_name),disabled:a===e.id||N===e.id,title:"Reenviar mensagem",children:a===e.id?s.jsx(h.Z,{className:"h-3 w-3 animate-spin"}):s.jsx(u.Z,{className:"h-3 w-3"})}),s.jsx(n.z,{variant:"outline",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>S(e.id),disabled:a===e.id||N===e.id,title:"Remover da lista de pr\xe9-cadastrados",children:N===e.id?s.jsx(h.Z,{className:"h-3 w-3 animate-spin"}):s.jsx(p.Z,{className:"h-3 w-3"})})]})})]},e.id))})]})})})]})]})})})}[n,i,l,d,m,x,f]=N.then?(await N)():N,t()}catch(e){t(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},5315:e=>{e.exports=require("path")},49:e=>{e.exports=import("@radix-ui/react-label")},3567:e=>{e.exports=import("@radix-ui/react-select")},4338:e=>{e.exports=import("@radix-ui/react-slot")},6926:e=>{e.exports=import("class-variance-authority")},6593:e=>{e.exports=import("clsx")},8097:e=>{e.exports=import("tailwind-merge")}};var r=require("../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[682,988],()=>a(654));module.exports=t})();